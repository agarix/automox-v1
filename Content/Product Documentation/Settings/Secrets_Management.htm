<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../Resources/TableStyles/ax_tables.css" rel="stylesheet" MadCap:stylesheetType="table" /><title></title>
        <meta name="Author" content="Valerie Bailey" MadCap:metaTagSet="Meta Tag Sets/AxMetaTags.flmeta" />
        <meta name="description" content="Description of how you cansecurely store and retrieve secrets (passwords, API keys, etc.) so that you can use them to execute Worklet policies without them being stored or exposed in plain text to any user." MadCap:metaTagSet="Meta Tag Sets/AxMetaTags.flmeta" />
    </head>
    <body>
        <h1>Secrets Management</h1>
        <p>With Automox Secrets Storage, you can securely store and retrieve secrets (passwords, API keys, etc.) so that you can use them to execute Worklet policies without them being stored or exposed in plain text to any user.</p>
        <p>Learn how to add, edit, and remove secrets, and associate them with worklet policies.</p>
        <div class="prereqs"><b>Prerequisites</b>: <br /><ul><li> You must have the required permissions to perform this action. See <MadCap:xref href="../Global Access Management/Roles_and_Permissions.htm">Roles and Permissions</MadCap:xref>.</li><li>Your organization is under a plan that includes worklets.</li></ul></div>
        <br />
        <div class="info"><b>Note</b>: <br /><ul><li>Secrets are currently compatible with the worklet policies.</li><li>You can use secrets in both PowerShell and Bash scripts.</li></ul></div>
        <h2>Accessing Secrets Management</h2>
        <p>You can add, edit, and delete secrets from the Secrets &amp; Keys page. In the Automox console, go to <strong>Settings</strong> at the top of the console and select <strong>Secrets &amp; Keys</strong>. For details about keys, refer to <MadCap:xref href="Managing_Keys.htm">Managing Keys</MadCap:xref>.</p>
        <p>
            <img src="../../Resources/Images/secrets-overview.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <h2>Adding a Secret</h2>
        <p>You can add secrets to each of your organizations. When you create worklet policies, you can use secrets to conceal sensitive information such as passwords or keys.</p>
        <div class="info"><b>Note</b>:<br /><ul><li>The Secret Name must be unique.</li><li>The character limit is 255 characters.</li><li>The maximum number of secrets within an organization is 1000.</li><li>You can add a maximum of 8 secrets at the same time. A maximum of 10 secrets can be associated with a single policy.</li></ul></div>
        <p>
            <img src="../../Resources/Images/add-zone-secret.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <p>To add secrets, follow these steps:</p>
        <ol start="1">
            <li>From the Secrets Management page, click <strong>Add Secret</strong>.</li>
            <li>Add an organization secret by entering a <strong>Secret Name</strong> and <strong>Value</strong> for the secret. These are required fields.<ul><li>To check the value you entered, click the eye icon.</li></ul></li>
            <li>Optionally, you can add a description.</li>
            <li>To add more secrets, click <strong>+ Add Secret </strong>and repeat the previous steps.</li>
            <li>Click<strong> Save Secrets</strong>.</li>
        </ol>
        <h2>Updating a Secret</h2>
        <p>You can update secrets in any organization you have access to.</p>
        <div class="info"><b>Note</b>:  It is not possible to change the Secret Name after it has been created.</div>
        <ol start="1">
            <li>From the Secrets Management page, find the secret you want to update.</li>
            <li>Click <strong>Edit</strong>.</li>
            <li>You can only modify the Description or the Value.</li>
            <li>Click <strong>Save</strong>.</li>
        </ol>
        <h2>Viewing Secrets</h2>
        <p>The following information is available from the <strong>Secrets Management</strong> page.</p>
        <table class="TableStyle-ax_tables" cellspacing="0" style="mc-table-style: url('../../Resources/TableStyles/ax_tables.css');">
            <col class="TableStyle-ax_tables-Column-Column1" />
            <col class="TableStyle-ax_tables-Column-Column1" />
            <thead>
                <tr class="TableStyle-ax_tables-Head-Header1">
                    <th class="TableStyle-ax_tables-HeadE-Column1-Header1">
                        <p>Table Column</p>
                    </th>
                    <th class="TableStyle-ax_tables-HeadD-Column1-Header1">
                        <p>Column Description</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-ax_tables-Body-Body1">
                    <td class="TableStyle-ax_tables-BodyE-Column1-Body1">
                        <p>Secret Name</p>
                    </td>
                    <td class="TableStyle-ax_tables-BodyD-Column1-Body1">
                        <p>The unique name for the secret you created.</p>
                        <p>The character limit is 255.</p>
                    </td>
                </tr>
                <tr class="TableStyle-ax_tables-Body-Body2">
                    <td class="TableStyle-ax_tables-BodyE-Column1-Body2">
                        <p>Description</p>
                    </td>
                    <td class="TableStyle-ax_tables-BodyD-Column1-Body2">
                        <p>Enter a description for the secret, but do not use the actual value of the secret.</p>
                    </td>
                </tr>
                <tr class="TableStyle-ax_tables-Body-Body1">
                    <td class="TableStyle-ax_tables-BodyE-Column1-Body1">
                        <p>Date Updated</p>
                    </td>
                    <td class="TableStyle-ax_tables-BodyD-Column1-Body1">
                        <p>Date and time any changes to the description or value were last made.</p>
                    </td>
                </tr>
                <tr class="TableStyle-ax_tables-Body-Body2">
                    <td class="TableStyle-ax_tables-BodyE-Column1-Body2">
                        <p>Associated Policies</p>
                    </td>
                    <td class="TableStyle-ax_tables-BodyD-Column1-Body2">
                        <p>Shows the number of associated policies. Click a number to view a list of associated policies, which allows you to link to a policy itself.</p>
                    </td>
                </tr>
                <tr class="TableStyle-ax_tables-Body-Body1">
                    <td class="TableStyle-ax_tables-BodyB-Column1-Body1">
                        <p>Actions</p>
                    </td>
                    <td class="TableStyle-ax_tables-BodyA-Column1-Body1">
                        <p>You can select from these options:</p>
                        <ul>
                            <li><b>Edit</b>: Click to edit the description or value.</li>
                            <li><b>Delete</b>: You can only delete the secret if it is not associated with a policy</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2>Deleting a Secret</h2>
        <p>Follow these steps to remove a secret from an organization.</p>
        <ol start="1">
            <li>From the Secrets Management page, find the secret you want to remove.</li>
            <li>Click <strong>Delete</strong> to remove the secret.</li>
            <li>If the secret has no associated policies, you can delete the secret in the dialog window that appears and it is removed from the list.</li>
            <li>If the secret is associated with a policy, see <MadCap:xref href="#Deleting">Deleting Secrets Associated With a Worklet Policy</MadCap:xref>.</li>
        </ol>
        <h2><a name="Deleting"></a>Deleting Secrets Associated With a Worklet Policy</h2>
        <p>This section describes how to delete a secret when it is referenced within a worklet policy.</p>
        <p>On the Secrets Management page, when a number is listed in the Associated Policies column, then the secret is associated with a worklet policy. This means that a worklet exists that uses an environmental variable in its code that references the secret. Refer to <MadCap:xref href="#Using">Using Secrets in a Worklet Policy</MadCap:xref>.</p>
        <p>
            <img src="../../Resources/Images/secrets-assoc-policy.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <p>In this scenario, there are two options to delete a secret from the Secrets Management page.</p>
        <ul>
            <li>Delete any variables from all policies that reference the secret. The policies remain intact.</li>
            <li>Delete any policies that reference the secret, then the secret can be deleted.</li>
        </ul>
        <ol start="1">
            <li>From the Secrets Management page, find the secret you want to remove.</li>
            <li>Click <strong>Delete</strong> to remove the secret.</li>
            <li>If the secret is associated with a worklet, a list of associated policies appears.<br /><img src="../../Resources/Images/policies-assoc.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" /><br /></li>
            <li>You must remove any association with policies before you can delete the secret. Click the name of the policy to open the policy page.</li>
            <li>Go to the list of <strong>Inputs</strong> where variables reference secrets within the policy.</li>
            <li>Find the variable that references the secret that you want to remove and click delete (x). <strong>Note</strong>: Make sure to update any code that uses the variable.</li>
            <li>Save the policy.</li>
            <li>Repeat for each policy that the secret is associated with.</li>
            <li>Return to the Secrets Management page. When there are no more policies associated with the secret, the number in the Associated Policies column shows 0.</li>
            <li>Click <strong>Delete</strong> to remove the secret from the organization.</li>
        </ol>
        <h2><a name="Using"></a>Using Secrets in a Worklet Policy</h2>
        <p>To securely use a secret within a worklet policy, you must add an environment variable that references the secret. This is done from the worklet policy page. Go to <strong>Automate &gt; Policies</strong> to create or edit a worklet policy.</p>
        <h3>Adding a Variable to a Worklet Policy</h3>
        <p>This describes how to add variables to a worklet policy.</p>
        <p>
            <img src="../../Resources/Images/worklet-inputs.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <ol start="1">
            <li>From the Create Worklet or Edit Worklet page, go to <strong>Inputs</strong>.</li>
            <li>Click <strong>Add Input</strong>.</li>
            <li>Enter a name in the <strong>Variable Name</strong> field to associate the secret with.<ul><li>The variable name must contain at least 3 characters, must start with a letter, and only use alphanumeric characters or underscores (for example, api_key_1).</li></ul></li>
            <li>Click the <strong>Select Organization Secret</strong> drop-down menu to select an appropriate secret that you previously created on the Secrets Management page.</li>
            <li>To add more variables, click <strong>Add Input</strong>.</li>
            <li>Use the variable name(s) in the code of your worklet. This variable references the secret, but never reveals the contents.</li>
            <li>Make any other required changes to the worklet and save the policy.</li>
        </ol>
        <h3>Editing Variables</h3>
        <p>This describes how to edit variables that are part of a worklet policy.</p>
        <p>
            <img src="../../Resources/Images/edit-variable.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <ol start="1">
            <li>From <strong>Automate &gt; Policies</strong>, go to the worklet that you want to edit variables for.</li>
            <li>From the list of <strong>Inputs</strong>, find the variable that you want to edit.</li>
            <li>You can edit the Variable Name, as needed.<ul><li>If you edit the variable name, ensure that the use of the variable in the code matches any changes that were made.</li></ul></li>
            <li>You can change the secret from the <strong>Select Organization Secret </strong>drop-down menu.<ul><li>If you do not see the secret you want to use, you must create it from the Secrets Management page in the same organization where the worklet policy is.</li></ul></li>
            <li>After making any changes, save the policy.</li>
        </ol>
        <h3>Mapping Variables to the Worklet Policy</h3>
        <p>The following examples show how variables can be directly or indirectly mapped in a worklet policy.</p>
        <p>There are two ways of mapping variables into the code:</p>
        <p><strong>Mapping Variables Method 1:</strong>
        </p>
        <p>You can reference input variables the same as any other Bash/Powershell variables by using the <strong>$</strong> sign. For example: <strong>$CUSTOM_TOKEN</strong></p>
        <p><strong>Input selection:</strong>
        </p>
        <p>
            <img src="../../Resources/Images/example-var1.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <p><strong>Explicitly calling variables into the code using the $ sign:</strong>
        </p>
        <p>
            <img src="../../Resources/Images/var1-remcode.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <p><strong>Mapping Variables Method 2:</strong>
        </p>
        <p>It is also possible to use environment variables indirectly. For example, the AWS cli expects environment variables with credentials to already exist. The variables will be exported to Powershell/Bash without the need to reference them directly in the script by using the <strong>$</strong> sign. For example: <strong>$VARIABLE_NAME</strong>.</p>
        <p><strong>Input selection:</strong>
        </p>
        <p>
            <img src="../../Resources/Images/input-vars-example.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <p><strong>Explicitly calling variables into the code using the $ sign:</strong>
        </p>
        <p>
            <img src="../../Resources/Images/vars-remcode2.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <p><strong>Indirect call to the variables:</strong>
        </p>
        <p>
            <img src="../../Resources/Images/export-vars.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <h3>Deleting Variables</h3>
        <p>You can remove any variables from the worklet policy list of Inputs by clicking <strong>x</strong> to delete it.</p>
        <div class="info"><strong>Note</strong>: If you delete a variable, ensure that it is not referenced in any script that is part of the worklet policy.</div>
        <h2>Related Topics</h2>
        <ul>
            <li>
                <MadCap:xref href="Settings_Overview.htm">Settings Overview</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="Managing_Keys.htm">Managing Keys</MadCap:xref>
            </li>
            <li><a href="https://university.automox.com/secrets-management" rel="nofollow">Automox University: Secrets Management</a>
            </li>
        </ul>
    </body>
</html>