<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title></title>
        <meta name="Author" content="Valerie Bailey" MadCap:metaTagSet="Meta Tag Sets/AxMetaTags.flmeta" />
        <meta name="description" content="This describes how to use the vulnerability sync feature to generate a resport using your third-party vulnerability scanner." MadCap:metaTagSet="Meta Tag Sets/AxMetaTags.flmeta" />
    </head>
    <body>
        <h1>Exporting Vulnerability Scanner Reports</h1>
        <p>In order to use the vulnerability sync feature, you must generate a report using your third-party vulnerability scanner. This document lists the types of vendor reports that are currently supported.</p>
        <div class="info"><b>Requirements for the CSV import</b>:
        <ul><li>The very first line in each CSV must contain the required data, depending on your CSV provider. For example: <code>hostname, cve id</code>. <br /><br />Follow the format requirements as noted in the console (<b>Add New Task</b> dialog window).<br /><br /></li><li>Hostnames are not case-sensitive.<ul><li>Hostnames should not be wrapped in any quotes, parenthesis, brackets, or single tics.<br /></li></ul></li><li>The CVE field should not contain any special characters. You can include dashes, for example: CVE-2021-1234, or commas for a list of CVEs.<br /></li><li>Severity is an optional field.<ul><li>Severities must use one of the following keywords unless otherwise indicated: <b>Critical</b>, <b>High</b>, <b>Medium</b>, <b>Low</b><br /></li></ul></li><li>The CSV report must be less than 1 GB.<br /></li><li>The CSV row maximum is 1 million rows.</li></ul></div>
        <p>Example CSV file:</p>
        <MadCap:codeSnippet>
            <MadCap:codeSnippetCopyButton />
            <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve" style="mc-code-lang: Bash;">Hostname, CVE ID, Severity
finance-laptop,cve-2021-1234,high
finance-laptop,cve-2021-6789
finance-laptop,cve-2021-5522,critical
sales_laptop,cve-2021-9944,medium</MadCap:codeSnippetBody>
        </MadCap:codeSnippet>
        <br />
        <div class="warning"><b>Note</b>:
<br />Using Notepad++ to open and save vulnerability scanner exports introduces hidden characters and can cause the manual import to fail. Automox recommends using a different source code editor.</div>
        <h2>Crowdstrike Falcon Spotlight - Vulnerability Report</h2>
        <p>Follow these instructions to download a vulnerability report from the Crowdstrike Falcon Spotlight platform.</p>
        <ul>
            <li>From the Crowdstrike dashboard, ensure that the report identifies hostnames and CVE IDs.</li>
            <li>Be sure to include relevant filters as there is a file size limit for the ingest of 1 GB.</li>
            <li>Additionally, be aware that more CVE IDs will mean more tasks to be created by Automox.</li>
        </ul>
        <p>Example of CrowdStrike’s Spotlight Vulnerability Dashboard. <strong>Note</strong>: It is possible to filter on relevant vulnerabilities for the export.</p>
        <p>
            <img src="../../Resources/Images/CS-spotlight-example.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <ul>
            <li>Select the file format CSV and export the report.</li>
        </ul>
        <p>
            <img src="../../Resources/Images/CS-spotlight-export.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <h2>Rapid7 - Vulnerability Report Export</h2>
        <p>Follow these instructions to manually create and export a vulnerability report from Rapid7 InsightVM/Nexpose.</p>
        <div class="info"><strong>Note:</strong> If you are using the <strong>Rapid7 InsightConnect</strong>, you do not need to manually export a vulnerability report from Rapid7 InsightVM/Nexpose. The vulnerability sync workflow bypasses the manual need to export and upload the report to Automox.<br /><br />When the synced imported report is ready, you can continue with the vulnerability process from the point of observing the mapping process until it is complete and take actions as required. Follow the description in our Vulnerability Sync documentation: <MadCap:xref href="Using_Automox_Vulnerability_Sync.htm">Using Automox Vulnerability Sync</MadCap:xref> → Syncing the Imported Report.<br /><br />See also <MadCap:xref href="../Automox Integrations/Automox_Plugin_for_Rapid7_InsightConnect.htm">Automox Plugin for Rapid7 InsightConnect</MadCap:xref>.</div>
        <br />
        <div class="info"><b>Requirements</b>: You must use the on-premise console to generate the report.</div>
        <h3>Creating a Rapid7 vulnerability report</h3>
        <p>In order to easily export vulnerability findings from Rapid7 InsightVM/Nexpose in a format that is quickly imported into Automox, we recommend creating a Custom SQL Report. This can be done within the InsightVM console by following these steps:</p>
        <ol start="1">
            <li>Navigate to <strong>Reports</strong>.</li>
            <li>On the Create a Report page, select <strong>Export</strong>.</li>
            <li>Select <strong>SQL Query Export</strong> from the list of templates.</li>
            <li>Add the query for the custom report and validate.</li>
            <li>Save and run the report.</li>
        </ol>
        <p>As new scans are performed, your Vulnerability Management team can regenerate reports and scope them to the groups, sites, and categories they are hoping to target. If the SQL query is modified for your environment needs, ensure the <strong>hostname</strong> and <strong>cve id</strong> fields are headers within the report export.</p>
        <h3>Query for custom SQL report</h3>
        <p>In the InsightVM/Nexpose Console, create a custom SQL Report using the following query:</p>
        <MadCap:codeSnippet>
            <MadCap:codeSnippetCopyButton />
            <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve" style="mc-code-lang: SQL;">select favf.asset_id, favf.vulnerability_id, da.host_name as hostname, dvf.reference as "cve id"
FROM fact_asset_vulnerability_finding favf
JOIN dim_vulnerability_reference dvf ON dvf.vulnerability_id = favf.vulnerability_id
JOIN dim_asset da ON da.asset_id = favf.asset_id
WHERE dvf.source = 'CVE'
</MadCap:codeSnippetBody>
        </MadCap:codeSnippet>
        <p>That query will yield a result something like the following:</p>
        <MadCap:codeSnippet>
            <MadCap:codeSnippetCopyButton />
            <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve" style="mc-code-lang: SQL;">asset_id, vulnerability_id, hostname, cve id
18, 200, hostname-1, CVE-2017-8682</MadCap:codeSnippetBody>
        </MadCap:codeSnippet>
        <p>Make sure that it is saved in CSV format and use that file to upload into the console. Feel free to apply other filters to the SQL report. See also the following example queries for Rapid7 vulnerability reports:</p>
        <h3>Query for vulnerabilities with severity of Critical</h3>
        <p>This query is used to create a report for CVEs with a severity level of "critical".</p>
        <MadCap:codeSnippet>
            <MadCap:codeSnippetCopyButton />
            <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve" style="mc-code-lang: SQL;">select favf.asset_id, favf.vulnerability_id, da.host_name as hostname, dvf.reference as "cve id"
FROM fact_asset_vulnerability_finding favf
JOIN dim_vulnerability_reference dvf ON dvf.vulnerability_id = favf.vulnerability_id
JOIN dim_vulnerability dv ON favf.vulnerability_id = dv.vulnerability_id
JOIN dim_asset da ON da.asset_id = favf.asset_id
WHERE dvf.source = 'CVE' and dv.severity = 'Critical'
</MadCap:codeSnippetBody>
        </MadCap:codeSnippet>
        <h3>Query for vulnerabilities by specific CVEs</h3>
        <p>This query is used to create a report for a specific CVE.</p>
        <MadCap:codeSnippet>
            <MadCap:codeSnippetCopyButton />
            <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve" style="mc-code-lang: SQL;">select favf.asset_id, favf.vulnerability_id, da.host_name as hostname, dvf.reference as "cve id"
FROM fact_asset_vulnerability_finding favf
JOIN dim_vulnerability_reference dvf ON dvf.vulnerability_id = favf.vulnerability_id
JOIN dim_asset da ON da.asset_id = favf.asset_id
WHERE dvf.reference = 'CVE-1234'
</MadCap:codeSnippetBody>
        </MadCap:codeSnippet>
        <p>If you need additional assistance or want to modify the query, use the Rapid7 documentation located here:</p>
        <p><a href="https://docs.rapid7.com/insightvm/creating-reports-based-on-sql-queries/" rel="nofollow">Creating reports based on SQL queries</a>
        </p>
        <h2>Tenable.io - CSV Vulnerability Export</h2>
        <p>To download a vulnerability report from <a href="http://tenable.io/" rel="nofollow">Tenable.io</a>, follow the documentation as described here: <a href="https://docs.tenable.com/security-center/Content/ExportVulnerabilityData.htm" rel="nofollow">Tenable Documentation: Export Vulnerability Data</a></p>
        <p>When exporting vulnerability data, you must include the following fields in the report:</p>
        <ul>
            <li>Host</li>
            <li>CVE</li>
            <li>Risk</li>
        </ul>
        <p>After exporting the data, you generally do not need to modify the report in order to upload it to Automox as long as you select <strong>Tenable Vulnerability Management</strong> for the CSV Provider. <b>Note</b>: It is recommended that you always verify that the headers are in the expected format.</p>
        <p>
            <img src="../../Resources/Images/import-csv-tenable.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <h2>Qualys - Scan Report</h2>
        <p>By exporting a Qualys New Scan Report, it is possible to upload vulnerability details from Qualys scans to remediate devices.</p>
        <p>To generate a scan report, navigate to <strong>Reports → Templates → New Scan Template</strong></p>
        <p>When Creating the Report Template, select <strong>Vulnerability Details</strong> to ensure that CVE information is included in the report. The Qualys report includes IP addresses and a list of CVE IDs for correlating with Automox. No modifications to the report are necessary in order to upload to Automox as long as you select <strong>Qualys</strong> for the CSV Provider:</p>
        <p>
            <img src="../../Resources/Images/import-csv-qualys.png" class="thumbnail" style="mc-thumbnail-max-height: auto;mc-thumbnail-max-width: 310px;" />
        </p>
        <h2>Related Topics</h2>
        <ul>
            <li>
                <MadCap:xref href="Using_Automox_Vulnerability_Sync.htm">Using Automox Vulnerability Sync</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="About_Automox_Vulnerability_Sync.htm">About Automox Vulnerability Sync</MadCap:xref>
            </li>
            <li><a href="https://developer.automox.com/openapi/axconsole/operation/uploadRemediationCSV/" rel="nofollow">Upload a CSV file to Automox through API</a>
            </li>
        </ul>
    </body>
</html>